---
simd: '0023'
title: Archiving snapshots on Arweave
authors:

- Joshua Benaron
  category: Standard/Meta
  type: Core
  status: Draft
  created: 2023-04-12
  feature: (fill in with feature tracking issues once accepted)

---

## Summary

This proposal's aim is to start a discussion around storing Solana's ledger history and hourly snapshots on Arweave,
paying out of Solana's inflation.

## Abstract

This proposal will ensure that snapshots are stored securely and permanently, while also making them easily accessible
for future use. The proposal also aims to begin a discussion around a method for funding the storage costs using inflation emissions.

## Motivation

Storing Solana's snapshots on Arweave ensures that they are stored securely and permanently, while also making them
easily accessible for future use. However, storing data on Arweave incurs storage costs, which need to be paid for by
someone. This proposal suggests using a portion of the inflation emissions generated by the Solana blockchain to fund
the storage costs.

## New Terminology

Arweave - a permanent storage network ("pay once, store forever") backed by the AR token.

Bundlr - a scaling solution for Arweave which allows instant upload/retrieval, supporting >20k TPS and the ability to pay for
storage in multiple tokens, including SOL. Bundlr is currently handling >90% of transactions on Arweave.

## Design

### Overview

The overall design uses a Geyser Plugin to stream and aggregate transactions and blocks into a DB (e.g. Postgres),
allowing us to compress and store them on Arweave, using Bundlr. We'll also take incremental hourly snapshots of accounts and store them
on Arweave.

### Snapshot Selection Process

An hourly snapshot of Solana's accounts is taken and stored on Arweave. Each snapshot will need to be verifiable such that anyone can pull the 
snapshot and verify that it is the correct state.

### Ledger archiving

Transactions will be stored in an external store powered by a Geyser plugin, e.g. a Postgres plugin piping transactions
and blocks into a Postgres table.

For archiving the ledger, ledger state can aggregated, compressed and stored on Arweave once a day. In order to reconstruct the ledger,
each archive can be pulled from Arweave in parallel and reconstructed by a validator

### Snapshot Storage Costs Estimates and Inflation Emission Distribution

The cost per PB on Arweave is currently ~$6m. This means the estimated annual cost to Solana would be ~$12m

In terms of a method for incentivization - a possible solution is to payout more inflation rewards to validators
who choose to archive state.

Another option is the foundation pays for the storage of the archives, similar to the BigQuery setup that currently exists

### Bundlr Integration

The Bundlr integration requires integrating the [Bundlr Rust SDK](https://github.com/Bundlr-Network/rust-sdk)

### Performance and Scalability

There shouldn't be any large performance issues with the Geyser plugin.

Arweave has no limits on storage capacity and Bundlr is built in such a way that data is buffered on to the network efficiently.
Bundlr also provides guarantees around data being stored on Arweave correctly. This means Bundlr can act as a safe
transport layer for data getting on to Arweave.

## Impact

Storing Solana's snapshots on Arweave ensures that they are stored securely and permanently, while also making them
easily accessible for future use. Funding the storage costs using a portion of the inflation emissions generated by the
Solana blockchain ensures that the costs are paid for in a sustainable and scalable manner. Additionally, it provides a
way for validators to contribute to the long-term viability of the Solana blockchain.

## Security Considerations

There will need to be some way to prove that the snapshot is valid and correct.

## Backwards Compatibility

[TBD]

## Drawbacks

[TBD]